---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import About from '../components/About.astro';
import Skills from '../components/Skills.astro';
import Projects from '../components/Projects.astro';
import Contact from '../components/Contact.astro';
import { getLangFromUrl, useTranslations, languages, defaultLang } from '../i18n';

// Generate static paths for both languages
export async function getStaticPaths() {
  return [
    { params: { lang: undefined } }, // Default language (Spanish) at /
    { params: { lang: 'en' } }        // English at /en
  ];
}

const { lang: urlLang } = Astro.params;
const lang = (urlLang && urlLang in languages ? urlLang : defaultLang) as keyof typeof languages;
const t = useTranslations(lang);

// Centralized resume data import (SSR/HMR optimization)
const resumeData = lang === 'es' 
  ? await import('../../resume_es.json')
  : await import('../../resume_en.json');

const { basics, education, certificates, languages: langs, skills, projects } = resumeData.default;
---

<Layout title={`${t('nav.home')} - Oscar David Valencia`}>
  <Hero basics={basics} />
  <About 
    basics={basics} 
    education={education} 
    certificates={certificates} 
    languages={langs} 
  />
  <Projects projects={projects} />
  <Skills skills={skills} />
  <Contact basics={basics} />
</Layout>

